# FileBox MCPï¼šåŸºäºæ–‡ä»¶ç³»ç»Ÿçš„AI Agentæ¶ˆæ¯ä¼ é€’ç³»ç»Ÿ

FileBox MCP æ˜¯ä¸€ä¸ªåŸºäºæ–‡ä»¶ç³»ç»Ÿçš„è½»é‡çº§AI Agentæ¶ˆæ¯ä¼ é€’ç³»ç»Ÿï¼Œå…è®¸ä¸åŒçš„AIå·¥å…·é€šè¿‡å…±äº«æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œç»“æ„åŒ–çš„æ¶ˆæ¯äº¤æ¢ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
bun install
```

### 2. æ„å»ºé¡¹ç›®

```bash
bun run build
```

**é‡è¦ï¼š** æ¯æ¬¡ä¿®æ”¹ä»£ç åéƒ½éœ€è¦é‡æ–°è¿è¡Œ `bun run build` æ¥ç¡®ä¿MCPæœåŠ¡å™¨ä½¿ç”¨æœ€æ–°çš„ä»£ç ã€‚

### 3. é¡¹ç›®é…ç½®

åœ¨æ¯ä¸ªå‚ä¸é€šä¿¡çš„é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»º `.filebox` é…ç½®æ–‡ä»¶ï¼Œå®šä¹‰å½“å‰é¡¹ç›®çš„ä»£ç†èº«ä»½å’Œæ‰€æœ‰ä»£ç†çš„é¡¹ç›®æ ¹è·¯å¾„ï¼š

```json
{
  "current_agent": "qa_agent",
  "agents": {
    "qa_agent": "/path/to/qa_repo_root",
    "dev_agent": "/path/to/dev_repo_root",
    "frontend_agent": "/path/to/frontend_repo_root",
    "backend_agent": "/path/to/backend_repo_root"
  }
}
```

ä½ å¯ä»¥å‚è€ƒé¡¹ç›®ä¸­çš„ `.filebox.example` æ–‡ä»¶ã€‚

**é…ç½®è¯´æ˜ï¼š**
- `current_agent`: å½“å‰é¡¹ç›®çš„ä»£ç†æ ‡è¯†ç¬¦
- `agents`: æ‰€æœ‰å‚ä¸é€šä¿¡çš„ä»£ç†åŠå…¶é¡¹ç›®æ ¹ç›®å½•è·¯å¾„çš„æ˜ å°„

**æ³¨æ„äº‹é¡¹ï¼š**
- `.filebox` æ–‡ä»¶å¿…é¡»æ”¾åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹
- `current_agent` å¿…é¡»å­˜åœ¨äº `agents` é…ç½®ä¸­
- è·¯å¾„å¿…é¡»æ˜¯ç»å¯¹è·¯å¾„ï¼ŒæŒ‡å‘å„ä¸ªä»£ç†é¡¹ç›®çš„æ ¹ç›®å½•

#### 3.3 MCPæœåŠ¡å™¨é…ç½®

åœ¨ä½ çš„ MCP é…ç½®æ–‡ä»¶ä¸­ï¼ˆå¦‚ `~/.cursor/mcp.json`ï¼‰æ·»åŠ ä»¥ä¸‹é…ç½®ï¼š

```json
{
  "mcpServers": {
    "FileBox-Server": {
      "command": "/path/to/bun",
      "type": "stdio",
      "args": ["/path/to/filebox-mcp/src/index.ts"],
      "autoApprove": [
        "filebox_send_message",
        "filebox_list_messages",
        "filebox_read_message",
        "filebox_resolve_message",
        "filebox_reject_message"
      ]
    }
  }
}
```

**é…ç½®è¯´æ˜ï¼š**
- å°† `/path/to/bun` æ›¿æ¢ä¸ºä½ çš„ `bun` å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„
- å°† `/path/to/filebox-mcp/src/index.ts` æ›¿æ¢ä¸ºé¡¹ç›®ä¸­ `src/index.ts` çš„å®é™…è·¯å¾„
- FileBox MCP ç°åœ¨ä¼šè‡ªåŠ¨ä» `.filebox` é…ç½®æ–‡ä»¶ä¸­è¯»å–æ‰€æœ‰é…ç½®ä¿¡æ¯ï¼Œä¸å†éœ€è¦é€šè¿‡ç¯å¢ƒå˜é‡ä¼ é€’é…ç½®

### 4. åˆ›å»ºé‚®ç®±ç›®å½•

ä¸ºæ¯ä¸ªAgenté¡¹ç›®åˆ›å»ºæ ‡å‡†çš„é‚®ç®±ç›®å½•ç»“æ„ï¼š

```bash
# ä¸ºæ¯ä¸ªé¡¹ç›®åˆ›å»ºé‚®ç®±ç›®å½•
mkdir -p /path/to/qa_repo/docs/mailbox/{inbox,outbox,done,cancel}
mkdir -p /path/to/frontend_repo/docs/mailbox/{inbox,outbox,done,cancel}
mkdir -p /path/to/backend_repo/docs/mailbox/{inbox,outbox,done,cancel}
```

### 5. é‡å¯ MCP æœåŠ¡å™¨

**é‡è¦ï¼š** ä¿®æ”¹é…ç½®æˆ–ä»£ç åï¼Œéœ€è¦é‡å¯ä½ çš„AIå·¥å…·ï¼ˆå¦‚Cursorï¼‰æ¥é‡æ–°åŠ è½½MCPæœåŠ¡å™¨å®ä¾‹ã€‚

## ğŸ“§ æ¶ˆæ¯æ ¼å¼

FileBox MCP ä½¿ç”¨ç®€åŒ–çš„email threadæ ¼å¼ï¼Œæ¯æ¬¡å›å¤éƒ½åœ¨æ¶ˆæ¯æ–‡ä»¶çš„å‰é¢æ·»åŠ æ–°å†…å®¹ï¼š

```markdown
# BR: Bugæ ‡é¢˜

**Format Version:** 1.0
**Message ID:** uuid
**Sender:** sender_agent_id
**Receiver:** receiver_agent_id
**Timestamp:** ISO8601æ—¶é—´æˆ³
**Original Sender:** original_sender_id
**Current Owner:** current_owner_id

===== MESSAGE THREAD =====

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

## 2025-06-30T08:25:15.890Z - dev_agent to qa_agent (ACK)

æœ€æ–°çš„å›å¤å†…å®¹...

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

## 2025-06-30T08:15:22.616Z - qa_agent to dev_agent (BR)

åŸå§‹æ¶ˆæ¯å†…å®¹...
```

### æ–‡ä»¶å‘½åè§„åˆ™

æ–‡ä»¶åæ ¼å¼ï¼š`YYYY-MM-DD_HHMM-TYPE-title-msgid.md`

- **æ—¶é—´æˆ³**ï¼š`2025-06-30_0815` (ç²¾ç¡®åˆ°åˆ†é’Ÿ)
- **æ¶ˆæ¯ç±»å‹**ï¼šä¿æŒåŸå§‹å‘èµ·è€…å®šä¹‰çš„ç±»å‹ï¼ˆBRã€ACKã€ERç­‰ï¼‰
- **æ ‡é¢˜**ï¼šæ¶ˆæ¯æ ‡é¢˜çš„slugæ ¼å¼
- **æ¶ˆæ¯ID**ï¼šUUIDçš„å‰8ä½

### å…³é”®æ”¹è¿›

1. **å¼ºåˆ†å‰²ç¬¦**ï¼šä½¿ç”¨ `â”â”â”` åˆ†å‰²çº¿æ˜ç¡®åŒºåˆ†ä¸åŒçš„æ¶ˆæ¯å›å¤
2. **å›ºå®šæ–‡ä»¶å**ï¼šå›å¤æ—¶ä¸æ”¹å˜æ–‡ä»¶åï¼Œç›´æ¥è¦†ç›–åŸæ–‡ä»¶
3. **ç®€åŒ–æ—¶é—´æˆ³**ï¼šæ–‡ä»¶åä¸­çš„æ—¶é—´æˆ³ç²¾ç¡®åˆ°åˆ†é’Ÿï¼Œæ ¼å¼æ›´ç®€æ´
4. **æ¸…æ™°çš„çº¿ç¨‹åˆ†éš”**ï¼šä½¿ç”¨ `===== MESSAGE THREAD =====` åˆ†éš”å…ƒæ•°æ®å’Œæ¶ˆæ¯å†…å®¹

## ğŸ› ï¸ å¼€å‘æµç¨‹

### ä¿®æ”¹ä»£ç åçš„æ­¥éª¤

1. **é‡æ–°æ„å»º**
   ```bash
   bun run build
   ```

2. **é‡å¯AIå·¥å…·**
   - é‡å¯Cursoræˆ–ä½ ä½¿ç”¨çš„AIå·¥å…·
   - è¿™ç¡®ä¿MCPæœåŠ¡å™¨ä½¿ç”¨æœ€æ–°çš„ä»£ç 

3. **æµ‹è¯•åŠŸèƒ½**
   - ä½¿ç”¨MCPå·¥å…·è¿›è¡Œæµ‹è¯•
   - æ£€æŸ¥æ¶ˆæ¯æ–‡ä»¶æ ¼å¼æ˜¯å¦æ­£ç¡®

### å¸¸è§é—®é¢˜

**Q: ä¸ºä»€ä¹ˆä¿®æ”¹ä»£ç åMCPæœåŠ¡å™¨è¿˜åœ¨ä½¿ç”¨æ—§ä»£ç ï¼Ÿ**
A: éœ€è¦å…ˆè¿è¡Œ `bun run build` é‡æ–°æ„å»ºï¼Œç„¶åé‡å¯AIå·¥å…·æ¥é‡æ–°åŠ è½½MCPæœåŠ¡å™¨å®ä¾‹ã€‚

**Q: ä¸ºä»€ä¹ˆæ¶ˆæ¯çš„Senderä¿¡æ¯ä¸æ­£ç¡®ï¼Ÿ**
A: æ£€æŸ¥MCPé…ç½®ä¸­æ¯ä¸ªAgentçš„ `current_agent_id` æ˜¯å¦æ­£ç¡®è®¾ç½®ï¼Œå¹¶ç¡®ä¿é‡å¯äº†AIå·¥å…·ã€‚

**Q: æ¶ˆæ¯æ–‡ä»¶åœ¨å“ªé‡Œï¼Ÿ**
A: æ¶ˆæ¯æ–‡ä»¶å­˜å‚¨åœ¨é…ç½®çš„ `mailbox_path` ç›®å½•ä¸‹çš„ `inbox`ã€`outbox`ã€`done`ã€`cancel` å­ç›®å½•ä¸­ã€‚

## ğŸ§ª æµ‹è¯•

è¿è¡Œå®Œæ•´çš„æ¶ˆæ¯çº¿ç¨‹æµ‹è¯•ï¼š

```bash
bun test_filebox.cjs
```

è¿™ä¼šæ¨¡æ‹Ÿä¸€ä¸ªå®Œæ•´çš„Bugä¿®å¤æµç¨‹ï¼ŒåŒ…æ‹¬ï¼š
1. QA Agentå‘é€BugæŠ¥å‘Š
2. Dev Agentå›å¤ç¡®è®¤
3. QA Agentè¡¥å……ä¿¡æ¯
4. Dev Agentæä¾›è§£å†³æ–¹æ¡ˆ
5. éªŒè¯æ¶ˆæ¯å†å²è®°å½•

## ğŸ“ é¡¹ç›®ç»“æ„

```
filebox-mcp/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ filebox.ts      # æ ¸å¿ƒFileBoxæœåŠ¡
â”‚   â”‚   â”œâ”€â”€ tools.ts        # MCPå·¥å…·å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ resources.ts    # MCPèµ„æºå®šä¹‰
â”‚   â”‚   â””â”€â”€ prompts.ts      # MCPæç¤ºå®šä¹‰
â”‚   â”œâ”€â”€ server/
â”‚   â”‚   â””â”€â”€ server.ts       # MCPæœåŠ¡å™¨å¯åŠ¨
â”‚   â””â”€â”€ index.ts            # ä¸»å…¥å£æ–‡ä»¶
â”œâ”€â”€ docs/                   # æ–‡æ¡£
â”œâ”€â”€ test_filebox.cjs        # æµ‹è¯•è„šæœ¬
â””â”€â”€ README.md
```

## ğŸ”§ MCPå·¥å…·

FileBox MCP æä¾›ä»¥ä¸‹å·¥å…·ï¼š

- `filebox_send_message` - å‘é€æ¶ˆæ¯
- `filebox_list_messages` - åˆ—å‡ºæŒ‡å®šä»£ç†çš„é‚®ç®±æ¶ˆæ¯
- `filebox_read_message` - è¯»å–æ¶ˆæ¯å†…å®¹
- `filebox_resolve_message` - æ ‡è®°æ¶ˆæ¯ä¸ºå·²è§£å†³
- `filebox_reject_message` - æ‹’ç»æ¶ˆæ¯

### runAs å‚æ•°æ”¯æŒ

æ‰€æœ‰å·¥å…·éƒ½æ”¯æŒå¯é€‰çš„ `runAs` å‚æ•°ï¼Œå…è®¸AIåœ¨åŒä¸€é¡¹ç›®ä¸­ä»¥ä¸åŒä»£ç†èº«ä»½æ‰§è¡Œæ“ä½œï¼š

```javascript
// ä»¥é»˜è®¤ä»£ç†èº«ä»½ï¼ˆé…ç½®ä¸­çš„ current_agentï¼‰å‘é€æ¶ˆæ¯
filebox_send_message({
  receiver_id: "frontend_agent",
  msg_type: "BR", 
  title: "BugæŠ¥å‘Š",
  content: "å‘ç°ä¸€ä¸ªé—®é¢˜..."
})

// æ˜ç¡®æŒ‡å®šä»¥ qa_agent èº«ä»½å‘é€æ¶ˆæ¯
filebox_send_message({
  receiver_id: "frontend_agent",
  msg_type: "BR",
  title: "BugæŠ¥å‘Š", 
  content: "å‘ç°ä¸€ä¸ªé—®é¢˜...",
  runAs: "qa_agent"
})

// æŸ¥çœ‹ frontend_agent çš„æ”¶ä»¶ç®±
filebox_list_messages({
  box_type: "inbox",
  runAs: "frontend_agent"
})
```

**runAs åŠŸèƒ½ç‰¹åˆ«é€‚ç”¨äºï¼š**
- åŒä¸€ä¸ªä»“åº“ä¸­åŒ…å«å¤šä¸ªå›¢é˜Ÿçš„ä»£ç ï¼ˆå¦‚QA + Frontend + Backendï¼‰
- AIéœ€è¦åœ¨ä¸åŒè§’è‰²é—´åˆ‡æ¢æ¥å¤„ç†è·¨å›¢é˜Ÿåä½œ
- æµ‹è¯•å¤šä»£ç†äº¤äº’åœºæ™¯

**å¤šä»£ç†å•ä»“åº“æ”¯æŒï¼š**
å½“å¤šä¸ªä»£ç†å…±äº«åŒä¸€ä¸ªé¡¹ç›®æ ¹è·¯å¾„æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ä¸ºæ¯ä¸ªä»£ç†åˆ›å»ºç‹¬ç«‹çš„é‚®ç®±ç›®å½•ï¼š
```
docs/mailbox/
â”œâ”€â”€ qa_agent/
â”‚   â”œâ”€â”€ inbox/
â”‚   â”œâ”€â”€ outbox/
â”‚   â”œâ”€â”€ done/
â”‚   â””â”€â”€ cancel/
â”œâ”€â”€ frontend_agent/
â”‚   â”œâ”€â”€ inbox/
â”‚   â””â”€â”€ ...
â””â”€â”€ backend_agent/
    â”œâ”€â”€ inbox/
    â””â”€â”€ ...
```

## ğŸ“ æ¶ˆæ¯ç±»å‹

- `BR` - Bug Reportï¼ˆç¼ºé™·æŠ¥å‘Šï¼‰
- `ER` - Enhancement Requestï¼ˆåŠŸèƒ½å¢å¼ºè¯·æ±‚ï¼‰
- `ACK` - Acknowledgementï¼ˆç¡®è®¤ï¼‰
- `DIS` - Discussionï¼ˆè®¨è®ºï¼‰

## ğŸ¯ è®¾è®¡ç›®æ ‡

- **ç®€å•æ€§**ï¼šåŸºäºæ–‡ä»¶ç³»ç»Ÿï¼Œæ— éœ€å¤æ‚çš„ç½‘ç»œåè®®
- **å¯è¿½æº¯æ€§**ï¼šå®Œæ•´çš„æ¶ˆæ¯å†å²è®°å½•
- **å¯è¯»æ€§**ï¼šäººç±»å¯è¯»çš„Markdownæ ¼å¼
- **å¯æ‰©å±•æ€§**ï¼šæ”¯æŒå¤šç§æ¶ˆæ¯ç±»å‹å’ŒAgent
